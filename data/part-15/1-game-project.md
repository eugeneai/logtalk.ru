---
path: '/part-15/1-document-preparation'
title: 'Общая структура проекта'
hidden: false
---

<text-box variant='learningObjectives' name='Идея решения'>

После изучения материала этого раздела Вы

- Напишите и выполните свою первую программу на Logtalk
- Узнаете, как реализовывать инкапсуляцию в этом языке в виде объекта
- Выполните несколько запросов к методам этого объекта

</text-box>


## Проект URL

https://github.com/stud-labs/logtalk-lab-gen

## Решаемые задачи и требования к системе порождения документов

Для порождения качественных документов необходимо

- Реализовать системы представления данных для документов
- Генерировать документ LuaLaTeX, который без ошибок должен быть сверстан
- Поддерживать шаблоны документов, специализируемые под требования организации
- Предусмотреть возможность генерации документов в другие форматы

В качестве примера возьмем задачу порождения документов для формироавния заявки на гранты Потанина для студентов-магистров.

## Реализация требований уровня пользователя

Пользователем программы является секретарь, программирующий на Logtalk.  Абсурдно, но пусть пока будут такие требования.  Далее можно улучшить систему, сделав WEB-интерфейс.

Итак нам надо распечатать документ, то есть, как вариант, сгенерировать PDF-файл.  Самый простой способ сделать качественный документ - использовать LuaLaTeX.  Благодяря тому, что исходный код документа - простой UTF8-текст и возможности настройки формата в отдельном файле (существуют десятки способов, как сделать настройку и удобно, и правильно, и быстро, и точно), сгенерировать документ достаточно просто.  Исходные данные для генератора - структура группы, оценки, и списко документов, адаптированных под университет и институт.

### Объект, представляющий группу студентов

Студенты задаются согласно шаблону: именительный и родительный падеж в виде option-списка (см. раздел "Стандартная библиотека"), пол студента, дата рождения.  Первый аргумент ```el/4``` - идентификатор студента.

```logtalk
:- object(group_anon,
   extends(studentGroup(02299-'ДМ'))). % TODO: где этот объект?

   el(maz, student([nom='Иванова Наталья Александровна',
                    dat='Ивановой Наталье Александровне'], f, 1987-05-30)).
   el(kur, student([nom='Петрова Елена Максимовна',
                    dat='Петровой Елене Максимовне'], f, 1983-12-12)).
   el(pop, student([nom='Сидоров Николай Петрович',
                    dat='Сидорову Николаю Петровичу'], m,  1999-09-13)).
:- end_object.
```

База данных оценок по предметам, представляется объектом ```notes/2```.  первый параметр - идентификатор студента, второй - option-список оценок.  Предметы в списке являются ключами и задаются идентификаторами.

```logtalk
:- object(notes_anon,
   implements(notesp)).

   notes(kur,
    [
        akm-5, is-5,

        fl1-ok, com-4, cmm-4, tpc-ok,
        iot-4, ddb-5, ml-5, spr-5,

        dis-5, sw-4, ssp-5,

        ais-5, fl2-ok, rec-5, rnd-ok,
        nn-5, ds-5, dda-5, kp1-5, ppr-5
    ]).
   notes(maz,
    [
        akm-5, is-5,

        fl1-ok, com-5, cmm-5, tpc-ok,
        iot-5, ddb-5, ml-5, spr-5,

        dis-5, sw-4, ssp-5,

        ais-4, fl2-ok, rec-4, rnd-ok, nn-4,
        ds-4, dda-4, kp1-5, ppr-5
    ]).
   notes(pop,
    [
        akm-5, is-5,

        fl1-ok, com-5, cmm-5, tpc-ok,
        iot-5, ddb-5, ml-5, spr-5,

        dis-5, sw-4, ssp-5,

        ais-5, fl2-ok, rec-5, rnd-ok,
        nn-5, ds-5, dda-5, kp1-5, ppr-5
    ]).
:- end_object.
```

### Представление списка документов для генерации

Собственно задача - сгенерировать документы для анонимной группы.

```logtalk
:- object(documents_anon).
   :- use_module(library(lists), [member/2]).
   :- public(gen/0).
   gen :-
       % debugger::trace,
       forall(member(FileName,['doc-anon.tex']), % можно использовать user
       % forall(member(FileName,[user]),         % для вывода на экран
              potaninDocuments(latexRenderer(FileName), % в какой формат
                   notes_anon, group_anon,              % документы
                   curriculum2023,   % учебный план (здесь предметы описаны)
                   fal)::gen).

   :- initialization(gen).  % инициализация
:- end_object.
```
